Credit to tayayan for the original code.
